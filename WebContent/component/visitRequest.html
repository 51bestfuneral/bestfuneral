<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head id="head">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<title>
预约
</title>
</head>
<script src="../../js/jquery-2.1.4.js"></script>
<script src="../../js/jquery-ui.js"></script>
<script src="../../js/angular-1.4.0-rc.2/angular.js"></script>
<script src="../../js/bootstrap-3.3.6-dist/js/bootstrap.js"></script>
<link href="../../js/bootstrap-3.3.6-dist/css/bootstrap.css" rel="stylesheet">
<link href="../../js/timepicker/css/bootstrap-datetimepicker.css" rel="stylesheet">
<script src="../../js/timepicker/js/moment-with-locales.js"></script>
<script src="../../js/timepicker/js/bootstrap-datetimepicker.js"></script>
<style>
    html {
	    width: 315px;
		height: 400px;
	}
    body {
	    text-align: center;
	}
	p {
	    margin: 0px;
	}
	#loginMain {
	    width: 369px;
		height: 423px;
		background-color: #ffffff;
        box-shadow: 0 20px 40px 0 rgba(0, 0, 0, 0.3);
	}
	#topPart {
	    width: 100%;
		overflow: auto;
		padding-top: 27px;
	}
	#mainTitle {
		width: 100%;
		text-align: center;
	}
	#mainTitle p {
	    font-size: 19px;
		font-weight: bold;
	}
	#closeArea {
	    float: right;
		overflow: auto;
		margin-right: 21px;
		margin-top: -40px;
		cursor: pointer;
	}
	#closeArea:hover {
	    background: #ff5274;
		color: #ffffff;
	}
	#closeArea p {
	    font-size: 18px;
		font-weight: bold;
	}
	#inputArea {
	    width: 302px;
		height: 340px;
		text-align: center;
		margin: 0px auto;
	}
	#inputArea .form-control{
	    width: 100%;
        height:	50.4px;
		border: solid 1px #333333;
		border-radius: 5px;
        background-color: #ffffff;
	}
	#inputArea .form-control:hover {
	    border: solid 1px #ff5274;
	}
	#remember {
	    margin-top: 15px;
		margin-bottom: 16px;
		overflow: auto;
	}
	#remember span {
	    font-size: 16px;
        line-height: 1.5;
        color: #b4b4b4;
		font-family: "Microsoft Yahei";
	}
	#submit {
	    width: 186px;
		height: 50px;
		border-radius: 84px;
		margin: 0px auto;
		background: #ff5274;
		text-align: center;
		margin-top: 20px;
		cursor: pointer;
	}
	#submit:hover {
	    background: #ff496d;
	}
	#submit p {
	    color: #ffffff;
		font-size: 19px;
		line-height: 50px;
	}
	#forget {
	    overflow: auto;
		float: left;
	}
	#forget p {
	    font-size: 14px;
        line-height: 1.5;
        color: #ff5274;
		cursor: pointer;
	}
	#forget p:hover {
	    color: #ff496d;
	}
	#alreadyHas {
	    overflow: auto;
		float: right;
	}
	#alreadyHas p {
	    font-size: 14px;
        line-height: 1.5;
        color: #ff5274;
		cursor: pointer;
	}
	#alreadyHas p:hover {
	    color: #ff496d;
	}
	#errorContent {
	    width: 100%;
        height:	30px;
		background: #fef2f2;
        border: 1px solid #ffb4a8;
	}
	#errorContent p {
	    font-size: 8px;
		text-align: center;
		line-height: 30px;
		margin: 0px;
	}
	#errorContentCoat {
	    width: 100%;
        height:	47px;
		padding-top: 17px;
	}
	.ddetails-header {
	    margin:0px auto;
		left: auto;
		float: none;
		margin-top: 10px;
		margin-bottom: 10px;
	}
	.checkcode {
	    height: 40px;
	}
	.input-group-addon {
	    height: 50px;
	}
	#phone {
	    margin-top: 20px;
	    margin-bottom: 20px;
	}
	select {
	    width: 100%;
	    height: 50px;
	    margin-top: 20px;
	    border-radius: 5px;
	}
</style>
<script>
var app = angular.module('myApp', []);
app.controller('cemetery', function($scope, $http) {
	$scope.cemeteryList = window.parent.cemeteryListBean;
});
</script>
<body ng-app="myApp" ng-controller="cemetery">
<div id="loginMain">
    <div id="topPart">
	    <div id="mainTitle">
		    <p>预约</p>
		</div>
		<div id="closeArea">
		    <p>X</p>
		</div>
	</div>
	<div id="inputArea">
	    <input type="text" class="form-control" placeholder="请输入您的电话号码"  ng-model="user.userName" id="phone"></input>
		        <div class='input-group date' id='datetimepicker1'>
        <input type='text' class="form-control mandantory" ng-model="user.birthday" id="requestDate"/>
            <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span>
            </span>
        </div>
        <select id="cemetery">
            <option ng-repeat=" bean in cemeteryList">{{bean.cemeteryName}}</option>
        </select>
		<div id="submit">
		    <p>预约</p>
		</div>
	</div>
</div>
</body>
<script>
$("#closeArea").click(function() {
    parent.removeSelf();
});
window.onload = function() {
	$('#datetimepicker1').datetimepicker({
	    format: "YYYY-MM-DD",
	    locale: "zh-cn",
	    viewMode: 'years'
	});
	$("#submit").click(function() {
		var user = {};

		user.requestPhone = $("#phone")[0].value;
		user.requestCemetery = $("#cemetery")[0].value;
		user.requestDate = $("#requestDate")[0].value;
		$.ajax({
	    	url: '/funeral/user/editCemeteryRequest',
			type: 'POST',
			contentType: "application/json; charset=UTF-8",
			dataType: 'json',
			data: JSON.stringify(user),
			success:function(data){
				if (data === 1) {
                	alert("请登录");
                	parent.removeSelf();
                	parent.popupLogInPage();
        		}
        		else {
        			alert("修改成功");
        			parent.removeSelf();
        		}
	    	},
		    error: function(error) {
			    alert(error);
		    }
	    });
	});
}
</script>
</html>