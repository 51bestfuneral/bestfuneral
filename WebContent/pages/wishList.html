<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head id="head"><title>
    Wish List
</title><meta name="description" content="Bleum provides high performance software development teams that
								deliver smart solutions, helping you to exceed your customers�?
								expectations for timely product delivery, zero defects, and a
								superior customer experience." /> 
<meta http-equiv="content-type" content="text/html; charset=utf-8" /> 
<meta http-equiv="pragma" content="no-cache" /> 
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="content-script-type" content="text/javascript" /> 
<script src="/funeral/js/jquery-2.1.4.js"></script>
<script src="/funeral/js/jquery-ui.js"></script>
<script src="/funeral/js/sliderx.js"></script>
<script src="/funeral/js/angular-1.4.0-rc.2/angular.js"></script>
<link href="/funeral/js/bootstrap-3.3.6-dist/css/bootstrap.css" rel="stylesheet">
<script src="/funeral/js/bootstrap-3.3.6-dist/js/bootstrap.js"></script>
<link href="/funeral/pages/component/css/secondLevelMenu.css" rel="stylesheet">

</head>

<header>
<IFRAME NAME="content_frame" width=100% SRC="/funeral/pages/component/topBar.html?cat=design" frameborder = 0 height = "65px"></IFRAME>

<div id="line0"></div>
<div id="link">
 <link1>	 <a href="#">为什么要定制葬礼</a>  </link1>
 <link2>   <a href="/funeral/pages/html/customizatonPages/howItWorks.html">怎样定制      </a>  </link2>
 <link3>   <a href="/funeral/pages/html/customizatonPages/costCalculator.html">定制计算</a>  </link3>
 <link4>   <a href="/funeral/pages/designProposal.html">定制套餐  </a>  </link4></div>

</header>


<style>
@media (min-width: 900px) {
  .container {
    width: 100%;
	padding: 0px;
	min-width: 1000px;
  }
}
.container {
    background: #F7F7F7;
}
#decorContainer {
    width: 1040px;
	margin: 0px auto;
	overflow: auto;
}
#tableHeader {
    width: 100%;
	overflow: auto;
}
#headerLeft {
    float: left;
	overflow: auto;
	text-align: left;
}
#headerLeft h1 {
    font-size: 32px;
	line-height: 95px;
	color: #3d3d3d;
	margin: 0px;
}
#headerRight {
    float: right;
	overflow: auto;
}
.rightImg {
    overflow: auto;
	float: right;
	height: 100%;
	margin-left: 10px;
}
.fakeImg {
	height: 95px;
}
.realImg {
    vertical-align: middle;
}
#shopTable {
    width: 100%;
	overflow: auto;
	padding-bottom: 22px;
	background: #ffffff;
}
#tableHeader {
    width: 100%;
	overflow: auto;
	background: #f2f2f2;
	box-shadow: 0px 2px 4px 0px rgba(162, 162, 162, 0.5);
}
#tableHeader div {
    float: left;
	text-align: center;
	height: 55px;
}
.tableContent {
    width: 100%;
	margin-top: 22px;
	overflow: auto;
}
.tableContent div {
	text-align: center;
	float: left;
}
.checkBox {
    width: 58px;
}
#tableHeader .checkBox input {
	margin-top: 22px;
}
.tableContent .checkBox input {
	margin:auto;
	margin-top: 32px;
}
.itemName {
    width: 422px;
	text-align: left!important;
}
.itemPrice {
    width: 140px;
}
.itemAmout {
    width: 140px;
}
.totalPrice {
    width: 140px;
}
.operation {
    width: 140px;
}
.operation span {
    color: #a6a6a6;
	font-size: 20px;
	cursor: pointer;
}
.title {
    font-size: 16px;
	color: #5b5b5b;
	margin: 0px;
	font-weight: bold;
}
.subTitle {
    font-size: 12px;
	color: #1c3653;
	line-height: 20px;
	margin: 0px;
}
#tableHeader .title {
    line-height: 55px;
}
.itemImg {
    width: 78px;
	height: 78px;
	background: #d8d8d8;
	cursor: pointer;
}
.itemImg:hover {
    border: 1px solid #ff5274;
}
.inputContent {
    padding-top: 14px;
}
.itemDesc {
    text-align: left!important;
	padding-left: 18px;
}
.itemDesc .title {
    cursor: pointer;
}
.itemDesc .title:hover {
    color: red;
}
#shopSumm {
    padding-left: 59px;
	padding-right: 71px;
	padding-bottom: 39px;
	padding-top: 24px;
	overflow: auto;
	background: #f2f2f2;
}
#leftSumm {
    float: left;
	width: 100%;
	margin-top: 15px;
}
.continue {
    overflow: auto;
	float: left;
}
.continue button {
    border: 1px solid #d7d7d7;
	background: #fff;
	color: #ff5274;
	border-radius: 4px;
	margin: 0px;
	font-size: 18px;
	width: 142px;
	height: 44px;
	font-family: "Microsoft Yahei";
}
#rightSumm {
    float: right;
	overflow: auto;
	width: 100%;
}
#rigthTop {
    overflow: auto;
	width: 100%;
}
#rigthTop div {
    float: right;
	text-align: right;
}
#rigthBottom {
    overflow: auto;
	text-align: right;
}
.next {
    overflow: auto;
    float: right;
}
.next button {
    width: 178px;
	height: 44px;
	border-radius: 4px;
	background: #ff5274;
	color: #ffffff;
	font-size: 18px;
	border: none;
	float: right;
	font-family: "Microsoft Yahei";
}
.next button:hover {
    background: #ff496d;
}
.summTitle {
    font-size: 20px;
	color: #5b5b5b;
	font-weight: bold;
	margin: 0px;
}
.titleNumber {
    color: #ff5274;
	padding-top: 0.4px;
}
#rigthTopContent {
    padding-right: 18px;
}
.oneThird {
    width: 33.33%;
	height: 100%;
    float: left;
}
.changeButton {
    background: #ccc;
	width: 20px;
	height: 20px!important;
	border-radius: 10px;
	cursor: pointer;
}
.changeButton:hover {
    opacity: 0.6;
}
.minusBitton {
    float: right!important;
}
.coverDiv {
    height: auto;
	width: 100%;
	top: 30px;
	bottom: 60px;
	text-align: center;
	position: fixed;
	z-index: 1001;
}
.coverDiv .detailFrame {
    height: 100%;
}
.closeCoverDiv {
	position: absolute;
	top: 0px;
	width: 35px;
	height: 35px;
	border-radius: 17px;
	border: 2px solid #979797;
	color: #979797;
	font-size: 30px;
	text-align: center;
	line-height: 35px;
	cursor: pointer;
}
.closeCoverDiv:hover {
	color: yellow;
	border: 2px solid yellow;
}
.coverImageDiv {
    height: auto;
	width: 100%;
	top: 30px;
	bottom: 60px;
	text-align: center;
	position: fixed;
	z-index: 1001;
}
</style>
<script type="text/javascript">
    var app = angular.module('productApp', []);
	var wishList;
	var usrId = 1;
    app.controller('product', function($scope, $http) {
	    $http.get("/funeral/wishlist/list?userId="+usrId).success(function(response) {
	        wishList = response[0];
			$http.get("/funeral/wishlistDetail/list?wishlistId="+wishList.ansListId).success(function(response) {
	            $scope.wishListDetails = response;
	        });
	    });
    });
	function calculate() {
	    var totalPrice = 0;
		for (i =0; i < $(".tableContent").length; i++) {

			var tableLine = $(".tableContent")[i];
			totalPrice = totalPrice + parseInt($(tableLine).find('.totalPrice').find('p')[0].innerText);
		}
		$("#rigthTopTitle").find(".titleNumber")[0].innerText = totalPrice;
		$("#rigthTopTitle").find(".titleNumber")[2].innerText = totalPrice + parseInt($("#rigthTopTitle").find(".titleNumber")[1].innerText);
	}
	function calculateEachLine(tableRow) {
		var singlePrice = tableRow.closest('.tableContent').find('.itemPrice')[0].innerText,
			count = parseInt(tableRow.closest('.tableContent').find('.itemAmout').find('.titleNumber')[0].innerText);
			
		tableRow.closest('.tableContent').find(".totalPrice").find('.titleNumber')[0].innerText = singlePrice*count;
	}
	function sendUpdateRequest(tableRow, count) {
	    var tableLine = tableRow.closest('.tableContent'),
		    wishListDetailId = tableLine[0].id,
			data = {
			    'count': count
			};

		$.ajax({
			url: '/funeral/wishlistDetail/edit/'+wishListDetailId,
			data: data,
			type: 'post',
			dataType:'json',
			success:function(data){
			},
			error: function(error) {
			}
		});
	}
	function sendDeleteRequest(tableRow) {
	    var tableLine = tableRow.closest('.tableContent'),
		    wishListDetailId = tableLine[0].id;

		$.ajax({
			url: '/funeral/wishlistDetail/delete/'+wishListDetailId,
			type: 'get',
			success:function(data){
				alert("您的信息我们已经收到？");
			},
			error: function(error) {
				alert("您的信息我们已经收到？");
			}
		});
	}
</script>
<body ng-app="productApp" ng-controller="product">
<div class="container">

    <div id="decorContainer">
	    <div id="pageHeader">
		    <div id="headerLeft">
			    <h1>您的购物车</h1>
			</div>
			<div id="headerRight">
			    <div class="rightImg">
				    <img class="fakeImg"></img>
				    <img src="/funeral/js/images/5.png" class="realImg"></img>
				</div>
				<div class="rightImg">
				    <img class="fakeImg"></img>
				    <img src="/funeral/js/images/2.png" class="realImg"></img>
				</div>
				<div class="rightImg">
				    <img class="fakeImg"></img>
				    <img src="/funeral/js/images/1.png" class="realImg"></img>
				</div>
			</div>
		</div>
		<div id="shopTable">
			<div id="tableHeader">
				<div class="checkBox">
					<input type="checkbox">
				</div>
				<div class="itemName">
				    <p class="title">产品和服</p>
				</div>
				<div class="itemPrice">
				    <p class="title">念念价格 </p>
				</div>
				<div class="itemAmout">
				    <p class="title">数量</p>
				</div>
				<div class="totalPrice">
				    <p class="title">小计 </p>
				</div>
				<div class="operation">
				    <p class="title">操作</p>
				</div>
			</div>
			<div class="tableContent">
				<div class="checkBox">
				    <input type="checkbox">
				</div>
				<div class="itemName">
				    <div class="itemImg">
					</div>
					<div class="itemDesc inputContent">
					    <p class="title">产品名称</p>
						<p class="subTitle">备注</p>
					</div>
				</div>
				<div class="itemPrice inputContent">
				    <p class="title">45.00</p>
				</div>
				<div class="itemAmout inputContent">
				    <div class="oneThird">
					    <div class="changeButton minusBitton">
						    <span>-</span>
						</div>
					</div>
					<div class="oneThird">
				        <p class="title titleNumber">1</p>
					</div>
					<div class="oneThird">
					    <div class="changeButton">
						    <span>+</span>
						</div>
					</div>
				</div>
				<div class="totalPrice inputContent">
				    <p class="title titleNumber">45.00</p>
				</div>
				<div class="operation inputContent">
				</div>
			</div>
			<div class="tableContent" id="{{wishListDetail.wishDetailId}}" ng-repeat="wishListDetail in wishListDetails">
				<div class="checkBox">
				    <input type="checkbox">
				</div>
				<div class="itemName">
				    <div class="itemImg">
					    <img src="{{wishListDetail.imageUrl}}"></img>
					</div>
					<div class="itemDesc inputContent">
					    <p class="title">{{wishListDetail.wishName}}</p>
						<p class="subTitle">{{wishListDetail.wishDesc}}</p>
					</div>
				</div>
				<div class="itemPrice inputContent">
				    <p class="title">{{wishListDetail.price}}</p>
				</div>
				<div class="itemAmout inputContent">
				    <div class="oneThird">
					    <div class="changeButton minusBitton">
						    <span>-</span>
						</div>
					</div>
					<div class="oneThird">
				        <p class="title titleNumber">{{wishListDetail.amount}}</p>
					</div>
					<div class="oneThird">
					    <div class="changeButton">
						    <span>+</span>
						</div>
					</div>
				</div>
				<div class="totalPrice inputContent">
				    <p class="title titleNumber">00.00</p>
				</div>
				<div class="operation inputContent">
				    <span class="glyphicon glyphicon-trash deleteButton"></span>
				</div>
			</div>
		</div>
		<div id="shopSumm">
			<div id="rightSumm">
			    <div id="rigthTop">
				    <div id="rigthTopTitle">
					    <p class="title titleNumber">25.00</p>
						<p class="title titleNumber">0</p>
						<p class="summTitle titleNumber">25.00</p>
					</div>
					<div id="rigthTopContent">
					    <p class="title">4 件商品，共计</p>
						<p class="title">运费</p>
						<p class="summTitle">订单总计</p>
					</div>
				</div>
			</div>
			<div id="leftSumm">
			    <div class="continue">
			    <button>继续购物</button>
				</div>
				<div class="next">
				<button id="nextButton">去结账 </button>
				</div>
			</div>
		</div>
	</div>
</div>
<IFRAME NAME="content_frame" width=100% height=300 marginwidth=0 marginheight=0 SRC="/funeral/pages/component/bottomBar.html" frameborder = 0></IFRAME>
</div>
<div class="coverDiv" hidden>
<div class="titleDiv">
<h1>物品详细信息</h1>
</div>
<IFRAME class="detailFrame" width=1165px marginwidth=0 marginheight=0 SRC="#" frameborder = 0></IFRAME>
<div class="closeCoverDiv"><span class="glyphicon glyphicon-remove"></span></div>
</div>
<div class="coverImageDiv" hidden>
<div class="closeCoverDiv"><span class="glyphicon glyphicon-remove"></span></div>
</div>
</body>
<script>
window.onload=function(){
    for (var j =0; j<$(".tableContent").length;j++) {
	    var tableLine = $($(".tableContent")[j]);
		calculateEachLine(tableLine);
	}
	calculate();
    $(".changeButton").click(function() {
	    var number = parseInt($(this).closest('.itemAmout').find(".titleNumber")[0].innerText),
		    changedNumber;

	    if ($(this).hasClass("minusBitton")) {
		    if (number>0) {
		        $(this).closest('.itemAmout').find(".titleNumber")[0].innerText = number - 1;
				changedNumber = number - 1;
			}
		}
		else {
		    $(this).closest('.itemAmout').find(".titleNumber")[0].innerText = number + 1;
			changedNumber = number + 1;
		}
		
		if (number != changedNumber) {
		    sendUpdateRequest($(this), changedNumber);
		    calculateEachLine($(this));
		    calculate();
		}
	});
	$(".deleteButton").click(function() {
	    $(this).closest('.tableContent').remove();
	    calculate();
		sendDeleteRequest($(this));
	});
	function muskPage() {
			$('<div class="jquery_addmask"> </div>').appendTo(document.body).css({ 
				position: 'absolute',
				top: '0px',
				left: '0px',
				'z-index': 1000, 
				width: $(document).width(), 
				height: $(document).height(), 
				'background-color': '#ccc', 
				opacity: 0 
			}).fadeIn('slow', function(){ 
	// 淡入淡出效果 
				$(this).fadeTo('slow', 0.5); 
		});
	};
	$(".itemImg").click(function() {
	    muskPage();
	    $(".coverImageDiv").fadeIn();
	});
	$(".itemDesc").find(".title").click(function() {
		    var parentWidth = $(".coverDiv").width(),
				frameWidth = $(".detailFrame").width();
	        $(this).css({
			    opacity: 0.5
			});
			muskPage();
			$(".detailFrame").attr("src","/funeral/pages/component/productDetail.html?id="+$(this)[0].id)
			$(".closeCoverDiv").css({
				right: (parentWidth-frameWidth)/2,
				left: 'auto',
				top: 0
			});
			$(".coverDiv").fadeIn(1000);
	});
	$(".closeCoverDiv").click(function() {
		$(".coverDiv").fadeOut();
		$(".coverImageDiv").fadeOut();
		$(".jquery_addmask").remove();
		$(".productItem").css({
			 opacity: 1
		});
	});
	$("#nextButton").click(function() {
	    window.location.href='paymentInfo.html';
	});
};
</script>
</html>