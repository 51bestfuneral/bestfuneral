<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head id="head">
<meta name="description" content="Bleum provides high performance software development teams that
								deliver smart solutions, helping you to exceed your customers°Ø
								expectations for timely product delivery, zero defects, and a
								superior customer experience." /> 
<meta http-equiv="content-type" content="text/html; charset=UTF-8" /> 
<meta http-equiv="pragma" content="no-cache" /> 
<meta http-equiv="content-style-type" content="text/css" /> 
<meta http-equiv="content-script-type" content="text/javascript" /> 
</head>
<script src="/js/jquery-2.1.4.js"></script>
<script src="/js/jquery-ui.js"></script>
<script src="/js/sliderx.js"></script>
<script src="/js/angular-1.4.0-rc.2/angular.js"></script>
<link href="/js/bootstrap-3.3.6-dist/css/bootstrap.css" rel="stylesheet">
<script src="/js/bootstrap-3.3.6-dist/js/bootstrap.js"></script>
<style>
html {
    height: 100%;
}
body {
    margin: 0;
	text-align: center;
	height: 100%;
}
.carousel-control {
    background-image: none!important;
	width: 15px;
	height: 54px;
	width: 54px;
    top: 100px;
}
.arrowCoat {
	width: 54px;
    height: 54px;
    border-radius: 27px;
	background-color: #f6f6f6;
}
.arrowCoat .headerArrow {
	line-height: 45px;
	color: #c6c6c6;
	font-size: 50px;
	margin: 0;
}
#maskDiv {
    position: absolute;
    top: 0;
    left: 0;
    z-index: 1000;
    width: 100%;
    height: 100%;
    background-color: #ccc;
    opacity: 0.5;
}
@media (min-width: 900px) {
  .container {
    width: 1349px;
	padding: 0px;
	min-width: 1000px;
  }
  body {
    width: 1349px;
	padding: 0px;
	min-width: 1000px;
  }
}
.coverDiv {
    height: auto;
	width: 100%;
	top: 30px;
	bottom: 60px;
	text-align: center;
	position: fixed;
	z-index: 1001;
}
.coverDiv .detailFrame {
    height: 100%;
}
.closeCoverDiv {
	position: absolute;
	top: 0px;
	width: 35px;
	height: 35px;
	border-radius: 17px;
	border: 2px solid #979797;
	color: #979797;
	font-size: 30px;
	text-align: center;
	line-height: 35px;
	cursor: pointer;
}
.closeCoverDiv:hover {
	color: yellow;
	border: 2px solid yellow;
}
.titleDiv {
    width: 1165px;
	height: 40px;
	margin: 0 auto;
	background-color: #ccc;
	text-align: left;
}
.titleDiv h1 {
    margin: 0px;
	margin-left: 15px;
	font-size: 20px;
	line-height: 40px;
}
	.productCarousel {
	    width: 1120px;
		margin: 0 auto;
		padding-top: 40px;
	}
	.productItem {
	    width: 230px;
		float: left;
		margin-left: 40px;
		border-bottom: 1px solid #ededed;
		box-shadow: 0px 5px 15px 0px rgba(0,0,0,0.15);
		background-color: #ffffff;
		border-radius: 4px;
		overflow: hidden;
		cursor: pointer;
		transition:box-shadow 0.3s;
	    -moz-transition:box-shadow 0.3s;
        -webkit-transition:box-shadow 0.3s;
        -o-transition:box-shadow 0.3s;
	}
	.productItem:hover {
	    box-shadow: 0px 10px 20px 0px #ff5274;
	}
	.productCarousel .carousel-control {
	    height: 54px;
		width: 54px;
        top: 180px;
		background-image: none;
	}
	.productCarousel .carousel-control.left {
	    left: -30px;
	}
    .productCarousel .carousel-control.right {
	    right: -30px;
	}
	.productCarousel .arrowCoat {
	    width: 54px;
		height: 54px;
		border-radius: 27px;
		background-color: #f6f6f6;
	}
	.productCarousel .arrowCoat .headerArrow {
	    line-height: 45px;
		color: #c6c6c6;
		font-size: 50px;
		margin: 0;
	}
	.productCarousel .carousel-indicators {
	    bottom: -45px;
	}
	.productInfo {
	    padding-top: 20px;
		padding-left: 15px;
		text-align: left;
		padding-bottom: 15px;
	}
	.productInfo .header {
	    font-size: 15px;
		color: #3b3d40;
		margin-bottom: 5px;
	}
	.productInfo .detail {
	    font-size: 12px;
		color: #f5274;
		margin-bottom: 20px;
	}
	#products {
	    padding-bottom: 50px;
	}
	.addWishButton {
	    cursor: pointer;
		border-radius: 3px;
		width: 130px;
		height: 28px;
		background-color: #ff5274;
		padding-left: 7px;
	}
	.addWishButton p {
	    color: white;
		font-size: 13px;
		line-height: 28px;
		float: left;
	}
	.addWishButton:hover {
	    background-color: #ff496d!important;
	}
	.addWishButton img {
	    float: left;
		margin-top: 5px;
	}
	.moreInfo {
	    border-top: 1px solid #ededed;
	}
	.moreInfo a{
	    line-height: 30px;
		color: #3078c0;
		font-size: 13px;
		border: 0px;
	}
	.disableDiv {
	    opacity: 0.5;
	}
</style>
<script type="text/javascript">
var app = angular.module('productApp', []);
var filter = location.search,
	wishList,
	usrId = 1;

app.controller('products', function($scope, $http) {
	$http.get("http://localhost:8080/bestfuneral/wishlist/list?userId="+usrId).success(function(response) {
	    wishList = response;
		function validateInList() {
	    $.ajax({
			url: 'http://localhost:8080/bestfuneral/wishlistDetail/list?wishlistId='+wishList[0].wishlistId,
			type: 'get',
			success:function(data){
				var response = data;
				for (var i=0;i<response.length;i++) {
				    var wishInList = response[i];
					if ($("#"+wishInList.wishId).length > 0) {
					    $("#"+wishInList.wishId).find(".addWishButton").addClass("disableDiv");
					}
				}
				if ($(".disableDiv").length>0) {
				    for (var i=0;i<$(".disableDiv").length;i++) {
				        $(".disableDiv").find("p")[i].innerText = "Â∑≤Âä†ÂÖ•ÊÑøÊúõÊ∏ÖÂçï";
					}
				}
			},
			error: function(error) {
				var response = error;
				//$(".disableDiv").find("p")[0].innerText = "Â∑≤Âä†ÂÖ•ÊÑøÊúõÊ∏ÖÂçï";
			}
		});
	}
	validateInList();
	});
	$http.get("http://localhost:8080/bestfuneral/wish/list"+filter).success(function(response) {
	    var j = 1,
		    counter = 1,
		    numberInRow = 4,
			objectsInRow = [],
			layouts = [];
		for (var i=0;i<response.length;i++) {
		    var singleProduct = response[i];

			if (j <= numberInRow) {
			    objectsInRow.push(singleProduct);
			}

			if (j === numberInRow || i === response.length-1) {
			    var layout = {},
				    active = '',
					itemLayout = objectsInRow;
					
				if (counter === 1) {
				    active = 'active'
				}
				layout = {
				    'index': counter,
					'active': active,
					'itemLayout': itemLayout
				};
				layouts.push(layout);
			    j = 0;
				counter++;
				objectsInRow = [];
			}
			j++;
		}
		$scope.layouts = layouts;
	});
});
</script>
<body ng-app="productApp" ng-controller="products">
<div class="container">
<div id="products">
	<div class="carouselProduct">
	    <div class="carousel slide productCarousel" id="referenceCarousel">
			<ol class="carousel-indicators">
				<li data-target="#referenceCarousel" data-slide-to="{{$index}}" class="{{layout.active}}" ng-repeat="layout in layouts"></li>
			</ol>
            <div class="carousel-inner">
				<div class="item {{layout.active}}" alt="Second slide" ng-repeat="layout in layouts">
	                <div class="productItem" id="{{itemLayout.wishId}}" ng-repeat="itemLayout in layout.itemLayout track by $index">
		                <div class="imageDiv">
						    <img src="../../js/images/product1.png" class="image"></img>
						</div>
						<div class="productText">
						    <div class="productInfo">
							    <p class="header">{{itemLayout.wishName}}</p>
								<p class="detail">ÂåÖÂê´Âú®ÊÇ®ÁöÑÂ•óÈ§ê‰∏≠(Âéü‰ª∑:Ôø•{{itemLayout.price}})</p>
								<div class="addWishButton" onselectstart="return false">
								    <img src="../../js/images/addWish.png"></img>
								    <p>Ê∑ªÂä†Ëá≥ÊÑøÊúõÊ∏ÖÂçï</p>
								</div>
							</div>
							<div class="moreInfo"><a href="{{itemLayout.url}}" class="moreInfo">‰∫ÜËß£ËØ¶ÊÉÖ</a></div>
						</div>
		            </div>
                </div>
            </div>
            <a class="carousel-control left" href="#referenceCarousel" 
                data-slide="prev"><div class="arrowCoat"><p class="headerArrow">&lsaquo;</p></div></a>
            <a class="carousel-control right" href="#referenceCarousel" 
                data-slide="next"><div class="arrowCoat"><p class="headerArrow">&rsaquo;</p></div></a>
        </div>
	</div>
</div>
</body>
<script>
window.onload=function(){
    $("body").on("click",".productItem",function() {
		    window.parent.muskPageForProduct($(this)[0].id);
	});
	$("body").on("click",".addWishButton",function() {
	    var data = {
			wishId: $(this).closest('.productItem')[0].id,
			wishlistId: wishList[0].wishlistId
		};
		if (!$(this).hasClass("disableDiv")){
			$.ajax({
				url: 'http://localhost:8080/bestfuneral/wishlistDetail/add',
				type: 'post',
				data: data,
				dataType:'json',
				success:function(data){
					alert("Â∑≤Âä†ÂÖ•ÊÑøÊúõÊ∏ÖÂçïÔºÅ");
				},
				error: function(error) {
					alert("Â∑≤Âä†ÂÖ•ÊÑøÊúõÊ∏ÖÂçïÔºÅ");
				}
			});
			$(this).addClass("disableDiv");
			$(this).find('p')[0].innerText = 'Â∑≤Âä†ÂÖ•ÊÑøÊúõÊ∏ÖÂçï';
		}
	});
};
</script>
</html>