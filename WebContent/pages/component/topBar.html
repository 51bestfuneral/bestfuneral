<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<script src="../../js/jquery-2.1.4.js"></script>
<script src="../../js/jquery-ui.js"></script>
<link href="../../js/Bootstrap/boot.css" rel="stylesheet">
<script src="/funeral/js/sliderx.js"></script>
<script src="/funeral/js/angular-1.4.0-rc.2/angular.js"></script>

<style>
    body {
	    margin: 0;
	}
    .topBar {
	    width: 100%;
		margin:0px auto;
		height:65px;
		box-shadow: 0px 2px 4px 0px rgba(162, 162, 162, 0.5);
	}
	.linkList {
	    width: 575px;
		margin:0px auto;
		height:100%;
		overflow:auto;
	}
	.linkList .includeLink {
	    float: left;
		width: 20%;
		text-align: center;
	}
	#rightSideLink {
	    overflow: auto;
		margin-top: -65px;
	}
	.sideLink {
	    width: 120px;
		float: right;
	}
	.includeLink {
		cursor:pointer;
		height: 65px;
		transition:background 0.5s;
		-moz-transition:background 0.5s;
        -webkit-transition:background 0.5s;
        -o-transition:background 0.5s;
	}
	.includeLink p {
	    margin-top: 21px;
		font-size: 18px;
	}
	.choose {
		background: rgb(244,244,244);
		border-bottom: 3px solid #B5AFAF;
	}
	.barSelect {
	    background: rgb(244,244,244);
		border-bottom: 3px solid #ff5274;
	}
	#leftSide {
	    width: 25%;
		float: left;
		text-align: center;
		margin-top: 22px;
	}
	#rightSide {
	    width: 75%;
		height: 100%;
		float: left;
	}
    .tickImg {
		margin: 0px;
        padding: 0px;
		width: 20px;
		height: 20px;
	}
	.sideIcon {
	    width: 20px;
		height: 20px;
		float: right;
		margin-top: 22px;
		margin-right: 20px;
		cursor: pointer;
	}
	.sideIcon img {
	    width: 100%;
		height: 100%;
		margin-left: 10px;
		margin-right: 10px;
	}
	.subIcon2 {
	    position: absolute;
		width: 14px;
		height: 14px;
		border-radius: 7px;
		background: #f62f5e;
		margin-left: 12px;
		margin-top: -4px;
	}
	.subIcon2 p {
	    color: #ffffff;
		line-height: 14px;
		margin: 0px;
		text-align: center;
	}
	.subIcon {
	    position: absolute;
		width: 14px;
		height: 14px;
		border-radius: 7px;
	}
	.subIcon1 {
	    position: absolute;
		width: 14px;
		height: 14px;
		border-radius: 7px;
		background: #f62f5e;
		margin-left: 12px;
		margin-top: -4px;
	}
	.subIcon1 p {
	    color: #ffffff;
		line-height: 14px;
		margin: 0px;
		text-align: center;
	}
</style>


<script type="text/javascript">
var app = angular.module('userApp', []);
app.controller('userController', function($scope, $http) {
	$http.get("/funeral/login/getCurrentUser").success(function(response) {
	    $scope.user = response;
	    var vuser=$scope.user;
	    if(vuser==null||""==vuser){
	    	$scope.account='登录/注册';
	    	}else{
	    		var vname=$scope.user.userName;   		
	    		if(vname.length>8){
	    		    $scope.account=vname.substr(0, 7);	
	    		  }else{
	    		  	 $scope.account=vname;
	    		  	} }});
	  });
</script>





<body  ng-app="userApp" ng-controller="userController">

<div class = "topBar">
    <span class = "topBarLogo" background-image = "http://www.bleum.com/images/logo.aspx"></span>
	<div class='linkList'>
	    <div class="includeLink" id="main">
	        <p>首页</p>
		</div>
	    <div class="includeLink" id="design">
	        <p>葬礼定制</p>
		</div>
		<div class="includeLink" id="product">
		    <p>产品及服务</p>
		</div>
		<div class="includeLink" id="cemetery">
	        <p>墓地信息</p>
		</div>
		<div class="includeLink" id="aboutUs">
		    <p>关于我们</p>
		</div>
		
	
		
	</div>
	<div id="rightSideLink">
	    <div class="sideIcon" id="wishlistIcon">
		    <div class="subIcon1">
			    <p>&#10004;</p>
			</div>
			<img src="../../js/images/wishlist-red@2x.png" class="tickImg"></img>
		</div>
		<div class="sideIcon" id="shoppingCartIcon">
		    <div class="subIcon2">
			    <p>6</p>
			</div>
			<img src="../../js/images/shopping-red@2x.png" class="tickImg"></img>
		</div>
	    <div class="includeLink sideLink" id="side2">
			<div id="leftSide">
				<img src="../../js/images/contact-red@2x.png" class="tickImg"></img>
			</div>
			<div id="rightSide">
				<p>{{account}}</p>
			</div>
		</div>
		<div class="includeLink sideLink" id="side">
			<div id="leftSide">
				<img src="../../js/images/contactUs.jpg" class="tickImg"></img>
			</div>
			<div id="rightSide">
				<p>联系我们</p>
			</div>
		</div>
	</div>
</body>
<script type="text/javascript">
    var length = location.search.length,
	type = location.search.substring(5, length);
	$("#"+type).addClass("barSelect");
	$(".includeLink").hover(function () {
        var $this = $(this);
        $this.addClass("choose");
	});
	$(".includeLink").on("mouseleave", function () {
        var $this = $(this);
        $this.removeClass("choose");
	});
	$("#main").on("click", function () {
	    if (type !== 'main') {
            window.parent.location.href='../mainPage.html';
		}
	});
	$("#design").on("click", function () {
	    if (type !== 'design') {
            window.parent.location.href='../funeralDesignPage.html';
		}
	});
	$("#product").on("click", function () {
	    if (type !== 'product') {
            window.parent.location.href='../productAndService.html';
		}
	});
	$("#cemetery").on("click", function () {
	    if (type !== 'cemetery') {
            window.parent.location.href='../cemeteryList.html';
		}
	});
	$("#aboutUs").on("click", function () {
	    if (type !== 'aboutUs') {
            window.parent.location.href='/funeral/pages/html/customizatonPages/aboutUs.html';
		}
	});
	function adjustLayout(userName) {
		$("#side").mouseenter(function () {
			var parent = $(window.parent.document.body),
				top = $('.topBar').height(),
				totalWidth = parent.width(),
				clientWidth = parent.find('.container').width(),
				right = 0;

			//	alert("parent="+parent+"  totalWidth= "+totalWidth+"  clientWidth="+clientWidth+"  right="+right);
			parent.append("<div id='contactSub' hidden></div><div id='contactUsInfo' hidden><iframe src='/funeral/pages/component/contactUs.html' width=735 height=290 frameborder = 0></iframe></div>");
			parent.find("#contactUsInfo").css({
				'width': '535px',
				'height': '240px',
				'position': 'absolute',
				'right': right,
				'top': top,
				'overflow': 'hidden',
				'box-shadow': '0 5px 30px 0 rgba(0, 0, 0, 0.3)',
				'z-index': 20
			});
			parent.find("#contactSub").css({
				'width': '0px',
				'height': '0px',
				'position': 'absolute',
				'right': right+220,
				'top': top-24,
				'overflow': 'hidden',
				'border-left': '20px solid transparent',
				'border-right': '20px solid transparent',
				'border-bottom': '24px solid #ffffff',
				'z-index': 21
			});
			parent.find("#contactUsInfo").fadeIn();
			parent.find("#contactSub").fadeIn();
			parent.find("#contactUsInfo").addClass("tempAdd");
			parent.find("#contactUsInfo").mouseenter(function () {
				$(this).addClass("tempAdd");
			});
			parent.find("#contactUsInfo").mouseleave(function () {
				$(this).removeClass("tempAdd");
				setTimeout (function () {
					if (!parent.find("#contactUsInfo").hasClass('tempAdd')) {
						parent.find("#contactUsInfo").fadeOut();
						parent.find("#contactSub").fadeOut();
					}
				}, 100);
			});
			parent.find("#contactSub").mouseenter(function () {
				parent.find("#contactUsInfo").addClass("tempAdd");
			});
		});
		$("#side").mouseleave(function (e) {
			var parent = $(window.parent.document.body);
			parent.find("#contactUsInfo").removeClass('tempAdd');
			setTimeout (function () {
				if (!parent.find("#contactUsInfo").hasClass('tempAdd')) {
					parent.find("#contactUsInfo").fadeOut();
					parent.find("#contactSub").fadeOut();
				}
			}, 100);
		});
		$("#wishlistIcon").mouseenter(function () {
			var parent = $(window.parent.document.body),
				top = $('.topBar').height(),
				totalWidth = parent.width(),
				clientWidth = parent.find('.container').width(),
				right = 0;
				
				
			//	alert("parent="+parent+"  totalWidth= "+totalWidth+"  clientWidth="+clientWidth+"  right="+right);
				
			parent.append("<div id='wishlistSub' hidden></div><div id='wishlistInfo' hidden><h3>愿望清单</h3><h4>您尚未定制愿望清单</h4><div class='navigateButton'><p>开始定制</p></div></div>");
			parent.find("#wishlistInfo").css({
				'width': '185px',
				'height': '107px',
				'position': 'absolute',
				'right': right,
				'top': top,
				'overflow': 'hidden',
				'z-index': '20',
				'padding-left': '13px',
				'box-shadow': '0 5px 30px 0 rgba(0, 0, 0, 0.3)',
				'background': '#ffffff'
			});
			parent.find("#wishlistInfo").find("h3").css({
				'font-size': '16px',
				'color': '#000000',
				'margin': '0px',
				'margin-top': '14px'
			});
			parent.find("#wishlistInfo").find("h4").css({
				'font-size': '11px',
				'color': '#7f7f7f',
				'margin': '0px',
				'margin-top': '5px'
			});
			parent.find("#wishlistSub").css({
				'width': '0px',
				'height': '0px',
				'position': 'absolute',
				'right': right+5,
				'top': top-12,
				'overflow': 'hidden',
				'border-left': '18px solid transparent',
				'border-right': '18px solid transparent',
				'border-bottom': '20px solid #ffffff',
				'z-index': 21
			});
			parent.find(".navigateButton").css({
				'width': '159px',
				'height': '26px',
				'background': '#ed4b83',
				'border-radius': '5px;',
				'z-index': '21',
				'margin-top': '9px',
				'cursor': 'pointer'
			});
			parent.find(".navigateButton").find("p").css({
				'line-height': '26px',
				'text-align': 'center',
				'color': '#ffffff'
			});
			parent.find("#wishlistInfo").fadeIn();
			parent.find("#wishlistSub").fadeIn();
			parent.find("#wishlistInfo").addClass("tempAdd");
			parent.find("#wishlistInfo").mouseenter(function () {
				$(this).addClass("tempAdd");
			});
			parent.find("#wishlistInfo").mouseleave(function () {
				$(this).removeClass("tempAdd");
				setTimeout (function () {
					if (!parent.find("#wishlistInfo").hasClass('tempAdd')) {
						parent.find("#wishlistInfo").fadeOut();
						parent.find("#wishlistSub").fadeOut();
					}
				}, 100);
			});
			parent.find("#wishlistSub").mouseenter(function () {
				parent.find("#wishlistInfo").addClass("tempAdd");
			});
		});
		$("#wishlistIcon").mouseleave(function (e) {
			var parent = $(window.parent.document.body);
			parent.find("#wishlistInfo").removeClass('tempAdd');
			setTimeout (function () {
				if (!parent.find("#wishlistInfo").hasClass('tempAdd')) {
					parent.find("#wishlistInfo").fadeOut();
					parent.find("#wishlistSub").fadeOut();
				}
			}, 100);
		});
		$("#shoppingCartIcon").mouseenter(function () {
			var parent = $(window.parent.document.body),
				top = $('.topBar').height(),
				totalWidth = parent.width(),
				clientWidth = parent.find('.container').width(),
				right = 0;
				
				
			//	alert("parent="+parent+"  totalWidth= "+totalWidth+"  clientWidth="+clientWidth+"  right="+right);
				
			parent.append("<div id='shoppingSub' hidden></div><div id='shoppingInfo' hidden><h3>购物袋(6)</h3><div class='navigateButton'><p>前去购物袋</p></div></div>");
			parent.find("#shoppingInfo").css({
				'width': '185px',
				'height': '84px',
				'position': 'absolute',
				'right': right,
				'top': top,
				'overflow': 'hidden',
				'z-index': 20,
				'padding-left': '13px',
				'box-shadow': '0 5px 30px 0 rgba(0, 0, 0, 0.3)',
				'background': '#ffffff'
			});
			parent.find("#shoppingInfo").find("h3").css({
				'font-size': '16px',
				'color': '#000000',
				'margin': '0px',
				'margin-top': '14px'
			});
			parent.find("#shoppingSub").css({
				'width': '0px',
				'height': '0px',
				'position': 'absolute',
				'right': right+40,
				'top': top-12,
				'overflow': 'hidden',
				'border-left': '18px solid transparent',
				'border-right': '18px solid transparent',
				'border-bottom': '20px solid #ffffff',
				'z-index': 21
			});
			parent.find(".navigateButton").css({
				'width': '159px',
				'height': '26px',
				'background': '#ed4b83',
				'border-radius': '5px',
				'z-index': 21,
				'margin-top': '9px',
				'cursor': 'pointer'
			});
			parent.find(".navigateButton").find("p").css({
				'line-height': '26px',
				'text-align': 'center',
				'color': '#ffffff'
			});
			parent.find("#shoppingInfo").fadeIn();
			parent.find("#shoppingSub").fadeIn();
			parent.find("#shoppingInfo").addClass("tempAdd");
			parent.find("#shoppingInfo").mouseenter(function () {
				$(this).addClass("tempAdd");
			});
			parent.find("#shoppingInfo").mouseleave(function () {
				$(this).removeClass("tempAdd");
				setTimeout (function () {
					if (!parent.find("#shoppingInfo").hasClass('tempAdd')) {
						parent.find("#shoppingInfo").fadeOut();
						parent.find("#shoppingSub").fadeOut();
					}
				}, 100);
			});
			parent.find("#shoppingSub").mouseenter(function () {
				parent.find("#shoppingInfo").addClass("tempAdd");
			});
		});
		$("#shoppingCartIcon").mouseleave(function (e) {
			var parent = $(window.parent.document.body);
			parent.find("#shoppingInfo").removeClass('tempAdd');
			setTimeout (function () {
				if (!parent.find("#shoppingInfo").hasClass('tempAdd')) {
					parent.find("#shoppingInfo").fadeOut();
					parent.find("#shoppingSub").fadeOut();
				}
			}, 100);
		});
		if (userName !== null && userName !== undefined) {
		$("#side2").mouseenter(function () {
			var parent = $(window.parent.document.body),
				top = $('.topBar').height(),
				totalWidth = parent.width(),
				clientWidth = parent.find('.container').width(),
				right = 0;
				
				
			//	alert("parent="+parent+"  totalWidth= "+totalWidth+"  clientWidth="+clientWidth+"  right="+right);
			parent.append("<div id='userSub' hidden></div><div id='userInfo' hidden><div class='singleNav'><p>个人账户</p></div><div class='singleNav'><p>愿望清单</p></div><div class='singleNav'><p>退出</p></div></div>");
			parent.find("#userInfo").css({
				'width': '106px',
				'position': 'absolute',
				'right': right+90,
				'top': top,
				'overflow': 'auto',
				'z-index': 20,
				'box-shadow': '0 5px 30px 0 rgba(0, 0, 0, 0.3)',
				'padding-top': '5px',
				'padding-bottom': '5px',
				'background': '#ffffff'
			});
			parent.find(".singleNav").css({
				'width': '100%',
				'overflow': 'auto',
				'cursor': 'pointer'
			});
			parent.find(".singleNav").find("p").css({
				'text-align': 'center',
				'overflow': 'auto',
				'line-height': '26px',
				'margin': '0px',
				'color': "#000000"
			});
			parent.find(".singleNav").hover(function() {
				$(this).css({
					'box-shadow': '0 5px 30px 0 rgba(0, 0, 0, 0.3)'
				});
			}, function() {
				$(this).css({
					'box-shadow': 'none'
				});
			});
			parent.find("#userSub").css({
				'width': '0px',
				'height': '0px',
				'position': 'absolute',
				'right': right+90,
				'top': top-12,
				'overflow': 'hidden',
				'border-left': '18px solid transparent',
				'border-right': '18px solid transparent',
				'border-bottom': '20px solid #ffffff',
				'z-index': 21
			});
			parent.find("#userInfo").fadeIn();
			parent.find("#userSub").fadeIn();
			parent.find("#userInfo").addClass("tempAdd");
			parent.find("#userInfo").mouseenter(function () {
				$(this).addClass("tempAdd");
			});
			parent.find("#userInfo").mouseleave(function () {
				$(this).removeClass("tempAdd");
				setTimeout (function () {
					if (!parent.find("#userInfo").hasClass('tempAdd')) {
						parent.find("#userInfo").fadeOut();
						parent.find("#userSub").fadeOut();
					}
				}, 100);
			});
			parent.find("#userSub").mouseenter(function () {
				parent.find("#userInfo").addClass("tempAdd");
			});
		});
		$("#side2").mouseleave(function (e) {
			var parent = $(window.parent.document.body);
			parent.find("#userInfo").removeClass('tempAdd');
			setTimeout (function () {
				if (!parent.find("#userInfo").hasClass('tempAdd')) {
					parent.find("#userInfo").fadeOut();
					parent.find("#userSub").fadeOut();
				}
			}, 100);
		});
		}
		else {
		    $("#side2").click(function() {
			    window.parent.popupLogInPage();
			});
		}
	}
	$.ajax({
		url: '/funeral/login/validateLogin',
		type: 'GET',
		contentType: "application/json; charset=UTF-8",
		success:function(data){
            var resultCode =data;

			if (resultCode === "") {
	            adjustLayout();
			}
			else {
				adjustLayout(data.userName);
			}
		},
		error: function(error) {
		}
	});
</script>
</html>