<!DOCTYPE html >
<head id="head">
<title>念念--支付方式</title>
<meta name="description" content="念念网致力于打造智能葬礼产品和服务定制工具。念念主张“不要让你爱的人走的太匆忙”，鼓励充分尊重逝者意愿的提前定制，已实现“殡葬服务价格透明化、互联网化、个性化”为己任 。念念，也是中国最大的日系骨灰盒骨灰坛销售公司，最有特色的祭扫祭祀用品服务商。" /> 
<meta name="keywords" content="念念,念念网,葬礼定制,殡葬,上海殡葬,殡葬服务,上海墓地， 骨灰盒，骨灰坛，寿衣，日本骨灰盒，葬礼花费，佛事服务，私人定制，生前契约，葬礼保险,提前定制" /> 
<meta http-equiv="content-type" content="text/html; charset=utf-8" /> 
<meta http-equiv="pragma" content="no-cache" /> 
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="content-script-type" content="text/javascript" /> 
</head>
<link href="/css/paymentMethod.css" rel="stylesheet">
<script src="/js/jquery-2.1.4.js"></script>
<script src="/js/jquery-ui.js"></script>
<script src="/js/sliderx.js"></script>
<script src="/js/angular-1.4.0-rc.2/angular.js"></script>
<link href="/js/bootstrap-3.3.6-dist/css/bootstrap.css" rel="stylesheet">
<script src="/js/bootstrap-3.3.6-dist/js/bootstrap.js"></script>
<script src="/js/generalUsage.js"></script>
<body ng-app="payment" ng-controller="pay">

<div class="topBarDiv">
<IFRAME NAME="content_frame" width=100% SRC="/component/topBar.html?cat=product?cat=main" frameborder = 0 height = "67px"></IFRAME>
</div>
<div class="container">
<div id="paymentContain">
    <div id="infoContain">
	    <div id="paymentStatus">
		     <div class="statusPointer selected">
			 </div>
			 <div class="statusBar selected">
			 </div>
			 <div class="statusPointer selected">
			 </div>
			 <div class="statusBar selected">
			 </div>
			 <div class="statusPointer selected">
			 </div>
			 <div class="statusBar">
			 </div>
			 <div class="statusPointer">
			 </div>
		</div>
		<div id="paymentStatusDesc">
		     <div class="descDiv first">
			     <p class="selected">寄送</p>
			 </div>
			 <div class="descDiv second">
			     <p class="selected">确认</p>
			 </div>
			 <div class="descDiv">
			     <p class="selected">支付</p>
			 </div>
			 <div class="descDiv last">
			     <p>成功</p>
			 </div>
		</div>
		<div id="paymentMethod">
		    <div class="singleMethod">
			    <div class="methodTop">
				    <img src="/js/images/wangyin.png"></img>
				</div>
				<div class="methodBottom">
				    <input type="radio" name="optionsRadios" id="optionsRadios1" value="1" checked>
			        <span class="radioDesc">网银支付</span>
			        
			         <form name="chinapnrpayment" action="/chinapnrapi.jsp" method="post" target="_blank">
						<input type="hidden" id="chnTradeNo" name="OrdId"/>
						<input type="hidden" id="chnTotalFee" name="OrdAmt" />
						<input type="hidden" id="chnPhone" name="UsrMp"/>
					  <input type="hidden" id="cwishOrderId" name="cwishOrderId"/>

                        <span class="new-btn-login-sp">
                            <button id="chinapnrButton" style="display:none" type="submit" style="text-align:center;">确 认</button>
                        </span>
					</form>
				</div>
			</div>
			<div class="singleMethod">
			    <div class="methodTop">
				    <img src="/js/images/zhifubao.png" ></img>
				</div>
				<div class="methodBottom">
				    <input type="radio" name="optionsRadios" id="optionsRadios2" value="option1">
			        <span class="radioDesc">支付宝支付</span>
			        <form name="alipayment" action="/alipayapi.jsp" method="post" target="_blank">
						<input type="hidden" id="tradeNo"  name="WIDout_trade_no"  />
					    <input type="hidden" id="subject" name="WIDsubject" value="test" />
						<input type="hidden" id="totalFee" name="WIDtotal_fee" />
						<input type="hidden" name="WIDbody" value="test"/>
											  <input type="hidden" id="awishOrderId" name="awishOrderId"/>

                        <span class="new-btn-login-sp">
                            <button id="alipayButton" style="display:none" type="submit" style="text-align:center;">确 认</button>
                        </span>
					</form>
				</div>
			</div>
			
			
			<div class="singleMethod" hidden>
			    <div class="methodTop">
				    <img></img>
					<img></img>
				</div>
				<div class="methodBottom">
				    <input type="radio" name="optionsRadios" id="optionsRadios3" value="option1">
			        <span class="radioDesc">货到付款</span>
				</div>
			</div>
		</div>
	
			
			</div>
		</div>
	</div>
	<div id="footerContain">
	    <div id="footer">
		    <div id="prevButton">
			    <p>返回购物车</p>
			</div>
		    <div id="nextButton" ng-click="pay()" >
			    <p>下一步</p>
			</div>
		</div>
	</div>
	
<IFRAME NAME="content_frame" width=100% height=246 marginwidth=0 marginheight=0 SRC="/component/bottomBar.html" frameborder = 0></IFRAME>
</div>

<div class="coverDiv" hidden>
<div class="titleDiv">
<h1>物品详细信息</h1>
</div>
<IFRAME class="detailFrame" width=1165px marginwidth=0 marginheight=0 SRC="#" frameborder = 0></IFRAME>
<div class="closeCoverDiv"><span class="glyphicon glyphicon-remove"></span></div>
</div>
</body>
<script type="text/javascript">	
function popupConfirmPage() {
	var screenHeight = document.documentElement.clientHeight,
	    centerTop = (screenHeight-407)/2;
		$('<div class="jquery_addmask"></div>').appendTo(document.body).css({ 
				position: 'absolute',
				top: '0px',
				left: '0px',
				'z-index': 1000, 
				width: $(document).width(), 
				height: $(document).height(), 
				'background-color': 'rgba(0,0,0,.6)', 
				opacity: 0 
			}).fadeIn('slow', function(){ 
				$(this).fadeTo('slow', 1); 
		});
		$('<div id="payConfirmFrameCoat" hidden><iframe src="/component/payResult.html" id="payConfirmFrame"></iframe></div>').appendTo(document.body).css({ 
			height: 'auto',
			width: '100%',
			top: centerTop+'px',
			'text-align': 'center',
			position: 'fixed',
			'z-index': '1001',
		    'border': 'none'
		}).fadeIn('slow', function(){ 
			$(this).fadeTo('slow'); 
		});
		$("#payConfirmFrame").css({
			width: '440px',
			height: '463px',
			'z-index': 1001,
			'box-sizing': 'border-box',
			'border': 'none'
		});
		window.onresize = resizeLogin;
}


		var length = location.search.length;
var wishOrderId= location.search.substring(13, length);
	
	
      var app = angular.module('payment', []);
      
     	app.controller('pay', function($scope, $http) {
     		
	    	$http.get("/alipay/createOrder?wishOrderId="+wishOrderId).success(function(response) {
	           
	           $scope.order=response;   
	           $("#tradeNo").val($scope.order.orderNo);
	           $("#subject").val($scope.order.subject);
	           $("#totalFee").val($scope.order.payableAmount); 
	           $("#chnTradeNo").val($scope.order.orderNo);
	           $("#chnTotalFee").val($scope.order.payableAmount);
	           $("#awishOrderId").val($scope.order.wishOrderId);
	           $("#cwishOrderId").val($scope.order.wishOrderId);

	           
	           $("#nextButton").show();
	           
	           
	           
			});
	    
	    	$scope.pay = function(){ 
	    		
	    		
	    		popupConfirmPage();
	    		 $("#alipayButton").click();
	       	var payType = $("input[name='optionsRadios']:checked").val();
	      	  if(payType==1){
	      		  $("#chinapnrButton").click();
	      	  }
	   		  if(payType==2){
	   			  $("#alipayButton").click();
	     	  }
	 

	   };
	    
     
  });
 	

window.onload=function(){
    $("#prevButton").click(function () {
	    window.location.href='shoppingCart.html';
	});


	
$("#optionsRadios1").click(function () {
$("#creditName").attr('disabled',false); 
$("#creditNo").attr('disabled',false); 
$("#creditExpiredDate").attr('disabled',false); 
$("#CVcode").attr('disabled',false); 


	});
		
	
$("#optionsRadios2").click(function () {
$("#creditName").attr('disabled',true); 
$("#creditNo").attr('disabled',true); 
$("#creditExpiredDate").attr('disabled',true); 
$("#CVcode").attr('disabled',true); 

});

//$("#nextButton").hide();  	
};
</script>
</html>